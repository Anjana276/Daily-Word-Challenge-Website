{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daily Word Challenge</title>
  <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#f0f4ff] text-gray-800">
    {% include "partials/header.html" %}
    <div style="position: absolute; top: 20px; right: 30px; font-size: 18px;">
      <span style="margin-right: 20px;">üî• {{ streak.current_streak }}</span>
      <span>üèÜ {{ streak.longest_streak }}</span>
    </div>

  <div class="max-w-4xl mx-auto mt-10 p-6 bg-white rounded-2xl shadow-lg">
    <div class="flex justify-between items-center">
      <h1 class="text-4xl font-bold">{{ word }}</h1>
      <span class="text-sm font-medium px-4 py-1 bg-blue-100 text-blue-700 rounded-full capitalize">{{ level }}</span>
    </div>

    {% if word_data %}
      {% if word_data.phonetics %}
        <p class="mt-2 text-gray-500 italic">
          {{ word_data.phonetics.0.text }}
          {% if word_data.phonetics.0.audio %}
            <audio controls class="inline ml-2 align-middle">
              <source src="{{ word_data.phonetics.0.audio }}" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio>
          {% endif %}
        </p>
      {% endif %}

      {% for meaning in word_data.meanings %}
        <div class="mt-6">
          <h2 class="text-xl font-semibold">{{ meaning.partOfSpeech|capfirst }}</h2>

          {% for definition in meaning.definitions %}
            <div class="mt-2 p-4 bg-gray-50 rounded-md shadow-sm">
              <p><span class="font-semibold">Definition:</span> {{ definition.definition }}</p>
              {% if definition.example %}
                <p class="mt-1 text-gray-700"><span class="font-semibold">Example:</span> "{{ definition.example }}"</p>
              {% endif %}
              {% if definition.synonyms %}
                <p class="mt-1 text-sm text-gray-500">
                  <span class="font-semibold">Synonyms:</span> {{ definition.synonyms|join:", " }}
                </p>
              {% endif %}
            </div>
          {% endfor %}
        </div>
      {% endfor %}
    {% else %}
      <p class="mt-4 text-red-600">Sorry, no information available for this word.</p>
    {% endif %}

    <form action="{% url 'mark_as_learned' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="word" value="{{ word }}">
        <input type="hidden" name="definition" value="{{ word_data.meanings.0.definitions.0.definition }}">
        <input type="hidden" name="example" value="{{ word_data.meanings.0.definitions.0.example|default:'' }}">
        <input type="hidden" name="level" value="{{ level }}"> <!-- üî• Added this -->
        <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
          Mark as Learned
        </button>
    </form>

    {% if show_quiz %}
      <div style="margin-top: 20px; text-align: center;">
        <p>üéâ You've learned {{ learned_count }} words!</p>
        <a href="{% url 'quiz' %}">
          <button style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">
            Take Quiz Now
          </button>
        </a>
      </div>
    {% endif %}

    <a href="{% url 'progress' %}" class="text-blue-600 underline text-sm">View Progress</a>
  </div>
</body>
</html>
